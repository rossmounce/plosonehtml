
<h4>Tracking</h4>
<a id="article1.body1.sec2.sec2.p1" name="article1.body1.sec2.sec2.p1"></a><p>Following acquisition of the video, the position of the fly was tracked in each frame. For this study, the tracking was performed in the computing environment Matlab (<a href="http://www.mathworks.com/products/matlab/">http://www.mathworks.com/products/matlab​/</a>) using FTrack, a suite of functions and corresponding user interface written specifically for this research by one of the authors (DV). FTrack is available by request from the authors.</p>
<a id="article1.body1.sec2.sec2.p2" name="article1.body1.sec2.sec2.p2"></a><p>The tracking algorithm proceeds as follows <a href="#pone.0001083-Valente1">[22]</a>: In the videos acquired with the setup described above, the fly was a single ellipsoidal dot moving on a relatively constant background. Therefore, it was sufficient to find the fly in a frame obtained by subtracting the current frame <strong>I</strong>[<em>n</em>] from an averaged background <strong>I</strong><em><sub>B</sub></em>[<em>n</em>] and squaring the result<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.e001&amp;representation=PNG" class="inline-graphic"></span><br>where <em>n</em> is the current frame index. The background image is calculated from a running average, following the rule<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.e002&amp;representation=PNG" class="inline-graphic"></span><br>Here, 0.9&lt;α&lt;1 is a parameter that sets the (exponential) low pass temporal filter effectively used to compute the background. To further reduce false tracks, the area around the fly is excluded from the update, which prevents a motionless fly from becoming part of the background.</p>
<a id="article1.body1.sec2.sec2.p3" name="article1.body1.sec2.sec2.p3"></a><p>To determine the location of the fly, the pixel of maximum intensity is found in each frame, and a subset image <strong>I</strong><sub>Δ<em>sub</em></sub> around this pixel is extracted. The center of intensity of the subset image is calculated and used to calculate the object's <em>x</em> and <em>y</em> locations<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.e003&amp;representation=PNG" class="inline-graphic"></span><br>Here <em>i</em> and <em>j</em> correspond to row and column indices respectively; <em>L<sub>x</sub></em> and <em>L<sub>y</sub></em> are the dimensions of the subset image (in pixels); and <span class="inline-formula"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.e004&amp;representation=PNG" class="inline-graphic"></span> is the pixel of maximum intensity in the subset image. A caveat to the method is finding the fly in the first frame (<em>n</em> = 1). For this, a static background is calculated from a small number of initial frames. We have found that at a frame rate of 25 Hz, 100 frames is sufficient to calculate the background for a reasonably active fly.</p>


<h4>Correcting for Camera Tilt</h4>
<a id="article1.body1.sec2.sec3.p1" name="article1.body1.sec2.sec3.p1"></a><p>Although it is recommended to manually calibrate the orientation of the camera during the setup of the experiment, it is difficult to measure and completely eliminate any tilt that the camera plane may have. Unfortunately, such a tilt causes slight errors in measurement of positions and velocities from the video, since the video is capturing events projected onto a titled (as opposed to a parallel) plane. In the case of a circular arena, a tilt causes the arena to appear slightly elliptical. The deviation from circularity is measured by the eccentricity of the ellipse <span class="inline-formula"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.e005&amp;representation=PNG" class="inline-graphic"></span>, where <em>b</em> is the length of the semiminor axis of the ellipse and <em>a</em> is the length of the semimajor axis. Thus, positions and velocities are stretched along the major axis of the ellipse. This becomes apparent upon examination of the spatial probability distribution in the case of a fly walking along the boundary walls (refer to <a href="#pone-0001083-g002">Fig. 2</a> below); in polar coordinates, the location of the boundary will appear to oscillate around the arena radius instead of maintaining a constant value (figure not shown). Rotation of the camera confounds the issue.</p>
<div class="figure" id="pone-0001083-g002"><div class="img"><a name="pone-0001083-g002" title="Click for larger image " href="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.g002&amp;representation=PNG_M" data-doi="info:doi/10.1371/journal.pone.0001083" data-uri="info:doi/10.1371/journal.pone.0001083.g002"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001083.g002&amp;representation=PNG_I" alt="thumbnail" class="thumbnail"></a></div><div class="figure-inline-download">
            Download:
            <ul><li><div class="icon"><a href="/article/info:doi/10.1371/journal.pone.0001083.g002/powerpoint">
                    PPT
                  </a></div><a href="/article/info:doi/10.1371/journal.pone.0001083.g002/powerpoint">
                  PowerPoint slide
                </a></li><li><div class="icon"><a href="/article/info:doi/10.1371/journal.pone.0001083.g002/largerimage">
                    PNG
                  </a></div><a href="/article/info:doi/10.1371/journal.pone.0001083.g002/largerimage">
                  larger image
                  (<span id="info:doi/10.1371/journal.pone.0001083.g002.PNG_L"></span>)
                </a></li><li><div class="icon"><a href="/article/info:doi/10.1371/journal.pone.0001083.g002/originalimage">
                    TIFF
                  </a></div><a href="/article/info:doi/10.1371/journal.pone.0001083.g002/originalimage">
                  original image
                  (<span id="info:doi/10.1371/journal.pone.0001083.g002.TIF"></span>)
