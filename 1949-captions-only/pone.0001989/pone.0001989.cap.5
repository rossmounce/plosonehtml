
</div>

<div id="section3" class="section"><a id="s3" name="s3" toc="s3" title="Discussion"></a><h3>Discussion</h3><a id="article1.body1.sec3.p1" name="article1.body1.sec3.p1"></a><p>In this study, we propose a computational method to infer miRNA effective activity by integrating their binding affinities to target genes with gene expression changes measured by microarray experiment. With this method, we successfully detect activity enhancement of the miRNAs transfected to HeLa cells with high sensitivity and specificity. It should be noted that expression changes of the target genes for a miRNA reflects its effective regulatory activity change rather than expression change. This is one of the advantages of our method, since the expression level of a miRNA may not reflect its ability to down-regulate target genes. First, miRNA precursors need to be processed to become mature miRNA and post-transcriptional regulation may play important roles in controlling miRNA activities <a href="#pone.0001989-Wulczyn1">[36]</a>. Second, in some cases such as cancer, mutation of miRNA sequences may cause activity changes without substantially changing the expression levels. For these reasons, it may be more useful to measure or infer miRNA activity changes instead of measuring their expression changes. Unfortunately, some miRNA quantification methods such as miRNA microarray cannot effectively discriminate the expression levels of pre-miRNAs from those of mature miRNAs <a href="#pone.0001989-Lu1">[37]</a>, <a href="#pone.0001989-Volinia1">[38]</a>. Thus the miRNA expression levels measured by these methods do not reflect the actual regulatory activities of mature miRNAs. Furthermore, the number of large-scale miRNA profiling data is still limited, whereas a huge amount of microarray gene expression data are available from the public database such as Stanford Microarray Database (SMD) <a href="#pone.0001989-Demeter1">[39]</a> and Gene Expression Omnibus (GEO) <a href="#pone.0001989-Barrett1">[40]</a>. Our method may be implemented to these data sets and provide insight into miRNA activity regulation for further experimental investigation.</p>
<a id="article1.body1.sec3.p2" name="article1.body1.sec3.p2"></a><p>In this study, the target genes for miRNAs were predicted using miRanda algorithm <a href="#pone.0001989-John1">[41]</a>. The self-consistency in our analysis of the miRNA transfected HeLa cells suggests the reliability of the miRanda predictions. Other than the miRanda algorithm, several other target prediction methods have also been proposed such as TargetScan <a href="#pone.0001989-Lewis1">[30]</a>, DIANA-MicroT <a href="#pone.0001989-Kiriakidou1">[42]</a>, and PicTar <a href="#pone.0001989-Krek1">[43]</a>. We do not study the effect of different miRNA target prediction methods, since it is beyond the focus of this paper. As shown, our method is robust with respect to the possible false predictions in the miRNA-target binding score data. However, we expect further improvement of the results by our method if more accurate miRNA target gene prediction is available.</p>
<a id="article1.body1.sec3.p3" name="article1.body1.sec3.p3"></a><p>Our method relies on the connection between activity of a given miRNA and expression levels of its target genes. Although recent studies indicate that expression regulation at the mRNA level may be a common mechanism for miRNA function in both plants and animals, the debate about the regulatory mechanisms of animal miRNAs is far from being closed. It is possible that for some animal miRNAs translation repression is the major mechanism for target gene suppression. In this case, our method may not be able to detect the activity changes of these miRNAs based on gene expression data. Another limitation of our method is that different miRNAs are considered independently during the activity inference. But miRNA regulation may involve interactive activity between multiple miRNAs. How to take into account the synergistic miRNA regulation would be an interesting direction in the future studies.</p>
<a id="article1.body1.sec3.p4" name="article1.body1.sec3.p4"></a><p>In summary, we propose a method to infer effective activities of miRNA from microarray gene expression data and miRNA target predictions. This method can detect the activity enhancement of transfected miRNAs as well as the activity reduction of inhibited miRNAs with high sensitivity and specificity based on gene expression data. Since a huge amount of microarray expression data is available, we expect this method can be applied to infer miRNA regulations in many biological and medical research.</p>
</div>

<div id="section4" class="section"><a id="s4" name="s4" toc="s4" title="Materials and Methods"></a><h3>Materials and Methods</h3>
<h4>Overview</h4>
<a id="article1.body1.sec4.sec1.p1" name="article1.body1.sec4.sec1.p1"></a><p>We originally use a similar method to infer activity changes of transcription factors by integrating microarray data with ChIP-chip data or motif discovery data <a href="#pone.0001989-Cheng2">[44]</a>. Since transcription factor and miRNA share a common logic in gene expression regulation <a href="#pone.0001989-Hobert1">[34]</a>, in this paper we revise the method and apply it to infer the relative activities of miRNAs by combining gene expression profiling with miRNA target predictions. In a typical expression change profile, the expression changes of tens of thousands transcripts are measured simultaneously under two different conditions, i.e. mutant versus wild type. To infer the relative activity of a miRNA, we examine expression changes of its target transcripts: if they tend to be down-regulated, then the activity of this miRNA is likely to be enhanced; conversely, if they tend to be up-regulated, then the activity of this miRNA is likely to be repressed. Unfortunately, the complete list of target transcripts of miRNAs is usually not available from experiments. But a number of computational approaches have been suggested to predict miRNA targets, such as TargetScan <a href="#pone.0001989-Lewis1">[30]</a>, miRanda <a href="#pone.0001989-John1">[41]</a>, DIANA-microT <a href="#pone.0001989-Kiriakidou1">[42]</a>, RNAhybrid <a href="#pone.0001989-Rehmsmeier1">[45]</a>, and PicTar <a href="#pone.0001989-Krek1">[43]</a>. These approaches search the 3′-UTR sequences of mRNAs for potential miRNA binding motifs that have binding affinities to the miRNA over a cut-off value. In our method, we do not use a stringent cut-off value to determine target gene sets for miRNAs. In contrast, we utilize the predicted binding affinity scores directly, for the magnitude of binding affinities itself is informative as has been shown by <a href="#pone.0001989-Wang1">[24]</a>.</p>


<h4>Human miRNA target prediction</h4>
<a id="article1.body1.sec4.sec2.p1" name="article1.body1.sec4.sec2.p1"></a><p>In plants, miRNAs are highly complementary to their binding sequences and therefore miRNA target prediction is relatively easy <a href="#pone.0001989-Rhoades1">[46]</a>. In animals, a number of miRNA target prediction approaches have been suggested in the past few years <a href="#pone.0001989-Lewis1">[30]</a>, <a href="#pone.0001989-John1">[41]</a>–<a href="#pone.0001989-Krek1">[43]</a>, <a href="#pone.0001989-Rehmsmeier1">[45]</a>, <a href="#pone.0001989-Enright1">[47]</a>. In this paper, we utilize the data predicted by miRanda algorithm <a href="#pone.0001989-John1">[41]</a>, <a href="#pone.0001989-Enright1">[47]</a>, which include the target predictions for 211 of known miRNAs in human. The complete data set is available from the miRNAMap database at <a href="http://mirnamap.mbc.nctu.edu.tw/html/downloads.html">http://mirnamap.mbc.nctu.edu.tw/html/dow​nloads.html</a> <a href="#pone.0001989-Hsu1">[48]</a>. The miRanda algorithm is based on sequence complementarity between the mature miRNA and its target site, binding energy for the miRNA-target duplex, and the evolutionary conservation of the target site sequence and position in aligned UTRs of homologous genes found in human, mouse and rat <a href="#pone.0001989-John1">[41]</a>. This algorithm was used to scan the human miRNA sequences against the 3′-UTRs of all the human transcripts for potential target sites. Each predicted miRNA-target duplex is assigned a binding energy (a negative value) with the cut-off value being set to −12, namely, only those sites with binding energies less than −12 were considered to be the target sites.</p>
<a id="article1.body1.sec4.sec2.p2" name="article1.body1.sec4.sec2.p2"></a><p>The predicted binding energy reflects the binding potential of the miRNA to the target site: a lower binding energy indicates a higher binding potential. Based on this data, we generate a binding score matrix <em>B</em> = (<em>b<sub>ij</sub></em>)<em><sub>N</sub></em><sub>×<em>M</em></sub>, where M is 211, the number of known human miRNAs, and N is 4896, the number of genes that contain at least one target site of the 211 miRNAs. The binding score <em>b<sub>ij</sub></em> is the sum of absolute values of binding energies for all the target sites of miRNA <em>j</em> within the 3′-UTR of gene <em>i</em>. If gene <em>i</em> contains no target site of miRNA <em>j</em>, we set <em>b<sub>ij</sub></em> to zero. Some human genes may correspond to multiple mRNA transcripts and in this case the binding scores of these transcripts are averaged.</p>


<h4>Gene expression data in miRNA transfected cells</h4>
<a id="article1.body1.sec4.sec3.p1" name="article1.body1.sec4.sec3.p1"></a><p>In this paper, three independent miRNA transfection data sets are used, which are originally generated by Lim et al. <a href="#pone.0001989-Lim1">[23]</a>, Wang et al. <a href="#pone.0001989-Wang1">[24]</a>, and Linsley et al. <a href="#pone.0001989-Linsley1">[25]</a>, respectively. To investigate the influence of miRNAs on gene expressions, Lim et al. transfected exogenous miRNAs into the HeLa cells and measured gene expression changes of genes in the transfected cells versus non-transfected cells using two-channel Agilent microarrays <a href="#pone.0001989-Lim1">[23]</a>. This data set is available from the GEO database with the accession number GSE2075 <a href="#pone.0001989-Barrett1">[40]</a>.</p>
<a id="article1.body1.sec4.sec3.p2" name="article1.body1.sec4.sec3.p2"></a><p>In total, the effect of six miRNAs were examined in the data, including two wild-type miRNAs (miR-1 and miR-124), two mutant miRNAs of miR-124 (124mut5-6 and 124mut9-10), and two chimeric miRNAs (chimiR-124/1 and chimiR-1/124). The two mutant sequences of miR-124 were designed by switching bases at positions 5 and 6 (124mut5-6) and at positions 9 and 10 (124mut9-10), respectively. ChimiR-124/1 and chimiR-1/124 were two hybrid miRNAs. ChimiR-124/1 consists of the 5′-segment (10 bases) of miR-124 and the 3′-segment (12 bases) of miR-1, while chimiR-1/124 consisted of the 5′-segment (10 bases) of miR-1 and the 3′-segment (11 bases) of miR-124. These six miRNAs were transfected separately into HeLa cells and expression changes for more than 20,000 transcripts were measured at the 12 (12 h) and 24 (24 h) hours after transfection, resulting in 12 expression change profiles. In this data set some transcripts correspond to the same gene, namely, they have the same gene symbol. By averaging the measurements of transcripts corresponding to common genes, we finally obtained the relative expression levels of 15,223 different genes for each expression profile.</p>
<a id="article1.body1.sec4.sec3.p3" name="article1.body1.sec4.sec3.p3"></a><p>In the second data set, gene expressions were profiled in miR-124 transfected as well as non-transfected HepG2 cells at 7 time points using the Affymetrix GeneChips <a href="#pone.0001989-Wang1">[24]</a>. We compared the expression profiles in transfected cells with those in non-transfected cells at each time point to obtain 7 expression change profiles. That is, these expression change profiles measure the relative expression levels (log ratios) of genes in miR-124 over-expressed cells with respect to non-transfected controls. The third data set contains four expression change profiles, which measure the relative expression levels of genes in miR-16 and miR-106b over-expressed and inhibited Hela cells using the two channel Agilent microarrays (non-transfected cells as controls) <a href="#pone.0001989-Linsley1">[25]</a>. For both of these two data sets, multiple measurements for the same transcripts were averaged to represent the relative expression levels of genes.</p>


<h4>Inferring relative activities of miRNAs from gene expression data</h4>
<a id="article1.body1.sec4.sec4.p1" name="article1.body1.sec4.sec4.p1"></a><p>To calculate the relative activities of miRNAs, we examine the expression changes of all genes between two different conditions measured by microarray experiments, which is denoted as “expression change profile” in this article. The expression changes of genes are directly measured by cDNA arrays or calculated by comparing absolute gene expression levels captured by pairs of oligonucleotide arrays. Given an expression change profile <em>e</em> = (<em>e<sub>1</sub></em>,<em>e<sub>2</sub></em>, …, <em>e<sub>N</sub></em>) (e.g. expression changes of genes in mutant versus wild-type cells, in which <em>e<sub>i</sub></em> is the log ratio of gene i) and a binding score matrix <em>B</em> = (<em>b<sub>ij</sub></em>)<em><sub>N</sub></em><sub>×<em>M</em></sub> (e.g. the above described binding score matrix for known human miRNAs), where <em>N</em> and <em>M</em> are the total number of genes and miRNAs respectively, our method aims to identify the miRNAs that are associated with the gene expression changes in <em>e</em>. The basic idea is to examine the expressions of target genes of miRNA: if the target genes tend to be down-regulated, we infer its activity to be enhanced; conversely, if the target genes tend to be up-regulated, we infer its activity to be repressed.</p>
<a id="article1.body1.sec4.sec4.p2" name="article1.body1.sec4.sec4.p2"></a><p>For each miRNA, we calculate a score, termed the activity change score (AC score), which reflects the activity change of the miRNA. Suppose that we extract the binding scores corresponding to the current considered miRNA from the matrix B, and denote it as <em>b</em> = (<em>b</em><sub>1</sub>, <em>b</em><sub>2</sub>, …, <em>b<sub>N</sub></em>). To calculate the AC score, we first sort the expression vector <em>e</em> in a decreasing order and denote the sorted expression vector as <em>e</em>′ = (<em>e</em><sub>(1)</sub>, <em>e</em><sub>(2)</sub>, …, <em>e</em><sub>(<em>N</em>)</sub>). Accordingly, we rearrange the binding vector <em>b</em> into <span class="inline-formula"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e001&amp;representation=PNG" class="inline-graphic"></span>, where (<em>i</em><sub>1</sub>, <em>i</em><sub>2</sub>, …, <em>i<sub>N</sub></em>) are the indices of the ranked genes in <em>e</em>′. Note that <span class="inline-formula"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e002&amp;representation=PNG" class="inline-graphic"></span> and <em>e</em><sub>(<em>l</em>)</sub> correspond to the same gene <em>i<sub>l</sub></em>.</p>
<a id="article1.body1.sec4.sec4.p3" name="article1.body1.sec4.sec4.p3"></a><p>Second, we combine the two vectors <em>e</em>′ and <em>b</em>′ into a non-decreasing function <em>f</em>(<em>i</em>) defined as follows:<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e003&amp;representation=PNG" class="inline-graphic"><span class="note">(1)</span></span><br>where 1≤<em>i</em>≤<em>N</em>. Meanwhile we define another increasing function <em>g</em>(<em>i</em>) based only on <em>e</em>′ as<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e004&amp;representation=PNG" class="inline-graphic"><span class="note">(2)</span></span><br>If the activity of a miRNA does not change, genes with high and low binding affinities to the miRNA would locate randomly in the ranking list <em>e</em>′, and <em>f</em>(<em>i</em>) would increase in a stochastic manner. However, if the activity of a miRNA does change, for example in a down-regulated manner, genes with high binding affinities would rank high in <em>e</em>′, and <em>f</em>(<em>i</em>) would increase rapidly. The function <em>g</em>(<em>i</em>) serves as a control for comparison with <em>f</em>(<em>i</em>).</p>
<a id="article1.body1.sec4.sec4.p4" name="article1.body1.sec4.sec4.p4"></a><p>Third, we search for the index <em>i<sub>max</sub></em> that achieves the maximum deviation between <em>f</em>(<em>i</em>) and <em>g</em>(<em>i</em>), that is, <span class="inline-formula"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e005&amp;representation=PNG" class="inline-graphic"></span>. Then a pre-score is defined as<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e006&amp;representation=PNG" class="inline-graphic"><span class="note">(3)</span></span><br>Fourth, the pre-score is treated as a statistic and permutations are performed to obtain its distribution under the null hypothesis: no association between <em>e</em> and <em>b</em>. The binding vector <em>b</em>′ is permutated <em>K</em> times, resulting in <em>K</em> permuted binding vectors <em>b</em><sup>(1)</sup>, <em>b</em><sup>(2)</sup>, …, <em>b</em><sup>(<em>K</em>)</sup>. For each of the permutated binding vectors, we calculate a permutated pre-score and thereby we obtain a permutated pre-score vector denoted as <em>ps<sup>perm</sup></em> = (<em>ps</em><sup>1</sup>, <em>ps</em><sup>2</sup>, …, <em>ps<sup>K</sup></em>). The vector <em>ps<sup>perm</sup></em> represents the distribution of the pre-score under the null hypothesis and will be used for two purposes: (1) normalizing the pre-score and (2) assessing the significance of the activity change of a miRNA (to be described in the next section).</p>
<a id="article1.body1.sec4.sec4.p5" name="article1.body1.sec4.sec4.p5"></a><p>Since the pre-scores of different miRNAs may have different distributions under the null hypothesis, they are not directly comparable. Therefore, we normalize the pre-score into the AC score defined as the following:<a name="" id=""></a><span class="equation"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.e007&amp;representation=PNG" class="inline-graphic"><span class="note">(4)</span></span><br>where <em>MEAN</em>(<em>ps<sup>perm</sup></em>) is the mean of <em>ps<sup>perm</sup></em> and <em>SD</em>(|<em>ps<sup>perm</sup></em>|) is the standard deviation of the absolute values of <em>ps<sup>perm</sup></em>. In General, the permutated pre-score has a bimodal distribution as shown in <a href="#pone-0001989-g006">Figure 6</a>. It can be shown that if the expression change profile <em>e</em> is symmetric with respect to zero, the permutated pre-score would also have a symmetric distribution. In most microarray data, the symmetric assumption for the expression change profile <em>e</em> is approximately satisfied and therefore we use <em>SD</em>(|<em>ps<sup>perm</sup></em>|) to combine the standard deviations of the permutated pre-scores in the positive and negative sides. Certainly, the symmetry is not perfect: the distribution of the pre-scores may skew to one side. We use <em>MEAN</em>(<em>ps<sup>perm</sup></em>) to correct the skewness, which is usually close to zero. In practice, the AC score achieves a good normalization for the pre-scores of different miRNAs. The AC score can be either positive or negative: a positive value indicates an overall down-regulation of the target genes of a miRNA and thereby the enhanced activity of the miRNA. Conversely, a negative value indicates an overall up-regulation of the target genes of a miRNA and thereby the reduced activity of the miRNA.</p>
<div class="figure" id="pone-0001989-g006"><div class="img"><a name="pone-0001989-g006" title="Click for larger image " href="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.g006&amp;representation=PNG_M" data-doi="info:doi/10.1371/journal.pone.0001989" data-uri="info:doi/10.1371/journal.pone.0001989.g006"><img src="/article/fetchObject.action?uri=info:doi/10.1371/journal.pone.0001989.g006&amp;representation=PNG_I" alt="thumbnail" class="thumbnail"></a></div><div class="figure-inline-download">
            Download:
            <ul><li><div class="icon"><a href="/article/info:doi/10.1371/journal.pone.0001989.g006/powerpoint">
                    PPT
                  </a></div><a href="/article/info:doi/10.1371/journal.pone.0001989.g006/powerpoint">
                  PowerPoint slide
                </a></li><li><div class="icon"><a href="/article/info:doi/10.1371/journal.pone.0001989.g006/largerimage">
                    PNG
                  </a></div><a href="/article/info:doi/10.1371/journal.pone.0001989.g006/largerimage">
                  larger image
                  (<span id="info:doi/10.1371/journal.pone.0001989.g006.PNG_L"></span>)
                </a></li><li><div class="icon"><a href="/article/info:doi/10.1371/journal.pone.0001989.g006/originalimage">
                    TIFF
                  </a></div><a href="/article/info:doi/10.1371/journal.pone.0001989.g006/originalimage">
                  original image
                  (<span id="info:doi/10.1371/journal.pone.0001989.g006.TIF"></span>)
